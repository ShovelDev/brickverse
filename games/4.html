<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AgarSquare</title>
	<style type="text/css">
		*{
			font-family: sans-serif;
		}

		.leaderboard{
			position: absolute;
			margin: 0;
			right: 0;
			top: 0;
			width: 250px;
			height: 500px;
			background-color: #000a;
			color: white;
		}

		.leaderboard h1{
			margin: 0;
			width: 100%;
			height: 50px;
			border-bottom: solid 3px white;
		}
	</style>
</head>
<body>
	<canvas></canvas>
	<div class="leaderboard" id="leaderboard">
		<h1 align="center">LeaderBoard</h1>
		<p id="myPoints" align="center"></p>
	</div>
	<script type="text/javascript">
let UP = false, DOWN = false, LEFT = false, RIGHT = false;

let mouseX = 0;
let mouseY = 0;

let myPoints = 50;

let obj = [];
let coins = [];

obj.push({ id:"player", x:50, y:50, w:50, h:50 });
obj.push({ id:"bot", x:window.innerWidth/2-25, y:window.innerHeight/2-25, w:50, h:50 });
for(let i = 0; i < 50; i++){
	coins.push({ id:"coin", x:Math.floor(Math.random()*window.innerWidth), y:Math.floor(Math.random()*window.innerHeight), w: 10, h: 10, color: Math.floor(Math.random()*999999) });
}

let disX = 0;
let disY = 0;

function render(){
	hynz.draw.setColor('#333');
	hynz.draw.rect("fill",0,0,window.innerWidth,window.innerHeight);
	for(let n in coins){
		let mc = coins[n];
		hynz.draw.setColor('white');
		hynz.draw.rect("fill",mc.x,mc.y,mc.w,mc.h);
	}
	for(let i in obj){
		let mo = obj[i];
		if(mo.id == "player"){
			hynz.draw.setColor('#00f0');
		}
		if(mo.id == "bot"){
			hynz.draw.setColor('#f00');
		}
		hynz.draw.rect("fill",mo.x,mo.y,mo.w,mo.h);
	}
}

function verifyDistance(obj1,obj2){
	let cX1 = obj1.x+obj1.w/2;
	let cY1 = obj1.y+obj1.h/2;
	let cX2 = obj2.x+obj2.w/2;
	let cY2 = obj2.y+obj2.h/2;

	disX = cX1 - cX2;
	disY = cY1 - cY2;

	//hynz.draw.line(cX1,cY1,cX2,cY2);
}

function movement(){
	for(let i in obj){
		let mo = obj[i];
		if(mo.id == "player"){
			if(UP){
				mo.y -= 20;
			}
			if(LEFT){
				mo.x -= 20;
			}
			if(DOWN){
				mo.y += 20;
			}
			if(RIGHT){
				mo.x += 20;
			}
			mo.x = mouseX;
			mo.y = mouseY;
		}
		for(let n in coins){
			let mc = coins[n];
			mc.x -= disX * 0.007;
			mc.y -= disY * 0.007;
		}
		/*if(mo.id == "bot"){
			mo.x += disX * 0.1;
			mo.y += disY * 0.1;
		}*/
	}
}

function collide(){
	for(let i in obj){
		for(let n in coins){
			let mc = coins[n];
			if(obj[i].id == "bot"){
				let mo = obj[i];
				if(mo.x + mo.w > mc.x && mo.x < mc.x + mc.w && mo.y + mo.h > mc.y && mo.y < mc.y + mc.h){
					coins.splice(coins.indexOf(mc), 1);
					if(mo.w < 500 && mo.h < 500){
						mo.w += 3;
						mo.h += 3;
						mo.x = window.innerWidth/2-mo.w/2;
						mo.y = window.innerHeight/2-mo.h/2;
					}
					myPoints += 3;
					coins.push({ id:"coin", x:Math.floor(Math.random()*window.innerWidth), y:Math.floor(Math.random()*window.innerHeight), w: 10, h: 10, color:Math.floor(Math.random()*999999) });
				}
			}
		}
	}
}

let mo1;
let mo2;
function hynz_update(){
	render();
	movement();
	collide();
	
	for(let i in obj){
		if(obj[i].id == "player"){
			mo1 = obj[i];
		}
		if(obj[i].id == "bot"){
			mo2 = obj[i];
			document.getElementById('myPoints').innerHTML = `<b>You - ${myPoints}</b>`;
		}
	}
	verifyDistance(mo1,mo2);
}

document.querySelector('canvas').addEventListener("mousemove", (e)=>{
	mouseX = e.offsetX-25;
	mouseY = e.offsetY-25;
});

document.querySelector('canvas').addEventListener("keydown", (e)=>{
	if(e.key == "w"){
		UP = true;
	}
	if(e.key == "a"){
		LEFT = true;
	}
	if(e.key == "s"){
		DOWN = true;
	}
	if(e.key == "d"){
		RIGHT = true;
	}
});
window.addEventListener("keyup", (e)=>{
	if(e.key == "w"){
		UP = false;
	}
	if(e.key == "a"){
		LEFT = false;
	}
	if(e.key == "s"){
		DOWN = false;
	}
	if(e.key == "d"){
		RIGHT = false;
	}
});
  </script>
</body>
<script type="text/javascript" src="https://hynzjs.hynzstudios.repl.co/hynz.js"></script>
</html>
